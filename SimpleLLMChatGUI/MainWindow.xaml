<Window x:Class="SimpleLLMChatGUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Simple LLM Chat" Height="350" Width="450" Loaded="Window_Loaded"
        MinWidth="380" MinHeight="200"
        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!-- Top row: buttons -->
            <RowDefinition Height="*" />
            <!-- Chat output -->
            <RowDefinition Height="Auto" />
            <!-- Chat input + button -->
        </Grid.RowDefinitions>

        <!-- Top buttons row with Desktop Assistant Mode toggle in the middle -->
        <Grid Grid.Row="0" Margin="0,0,0,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Left: Clear Chat Button -->
            <Button Name="clearButton"
                    Content="Clear Chat"
                    Width="80"
                    Height="25"
                    Margin="0,0,5,0"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Left"
                    Grid.Column="0"
                    Click="clearButton_Click" />

            <!-- Center: Desktop Assistant Mode ToggleButton -->
            <ToggleButton Name="desktopAssistantToggle"
                          Content="Desktop Assistant Mode"
                          ToolTip="Desktop Assistant Mode (Ctrl+Shift+D) (Model must support images)"
                          Width="180"
                          Height="25"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Center"
                          Grid.Column="1" />

            <!-- Right: Options Button -->
            <Button Name="optionsButton"
                    Content="Options"
                    Width="80"
                    Height="25"
                    Margin="5,0,0,0"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Right"
                    Grid.Column="2"
                    Click="optionsButton_Click" />
        </Grid>

        <!-- Chat history -->
        <RichTextBox Name="chatOutput"
                     Grid.Row="1"
                     VerticalAlignment="Stretch"
                     HorizontalAlignment="Stretch"
                     Margin="0,0,0,5"
                     IsReadOnly="True" VerticalScrollBarVisibility="Auto">
            <RichTextBox.Resources>
                <Style TargetType="Paragraph">
                    <Setter Property="Margin" Value="0"/>
                    <Setter Property="Padding" Value="0"/>
                </Style>
            </RichTextBox.Resources>
        </RichTextBox>

        <!-- Input row (attach + textbox + send button) -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <!-- Attach button -->
                <ColumnDefinition Width="*" />
                <!-- Input expands -->
                <ColumnDefinition Width="Auto" />
                <!-- Send button -->
            </Grid.ColumnDefinitions>

            <!-- Attach button with PNG -->
            <ToggleButton Name="attachButton"
              Grid.Column="0"
              Width="40"
              Height="30"
              VerticalAlignment="Bottom"
              Margin="0,0,5,0"
              ToolTip="Attach Image (if supported by model)"
              Checked="attachButton_Checked"
              Unchecked="attachButton_Unchecked">
                <Image Source="pack://application:,,,/Resources/photoframe.png"
           Width="20" Height="20" Stretch="Uniform"/>
            </ToggleButton>

            <TextBox Name="chatInput"
                     Grid.Column="1"
                     Height="30"
                     VerticalAlignment="Bottom"
                     Margin="0,0,5,0"
                     HorizontalAlignment="Stretch" KeyDown="chatInput_KeyDown" />

            <Button Name="sendButton"
                    Grid.Column="2"
                    Content="Send"
                    Width="40"
                    Height="30"
                    VerticalAlignment="Bottom" Click="sendButton_Click" />
        </Grid>
    </Grid>
</Window>
