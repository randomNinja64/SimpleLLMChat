<Window x:Class="SimpleLLMChatGUI.Options"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            Title="Options" Height="575" Width="400"
            MinHeight="575" MinWidth="400" MaxWidth="400" MaxHeight="810"
            WindowStartupLocation="CenterOwner"
            ResizeMode="CanResize"
            Loaded="Window_Loaded"
            Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Options Form -->
        <ScrollViewer Grid.Row="0" Margin="0,0,0,10" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="8,0,8,0">

                <Label Content="Appearance" FontWeight="Bold" FontSize="14" Margin="0,0,0,0"/>

                <!-- Assistant Name -->
                <Label Content="Assistant Name:"/>
                <TextBox x:Name="AssistantNameTextBox"
                        Text="{Binding AssistantName, UpdateSourceTrigger=PropertyChanged}"
                        Height="23"/>

                <!-- Markdown Parsing -->
                <CheckBox x:Name="MarkdownParsingCheckBox"
                          Content="Enable Markdown Parsing"
                          IsChecked="{Binding MarkdownParsing, UpdateSourceTrigger=PropertyChanged}"
                          Margin="0,10,0,0"/>

                <!-- Show Tool Call Outputs -->
                <CheckBox x:Name="ShowToolOutputCheckBox"
                          Content="Show Tool Call Outputs"
                          IsChecked="{Binding ShowToolOutput, UpdateSourceTrigger=PropertyChanged}"
                          Margin="0,10,0,10"/>

                <Label Content="System" FontWeight="Bold" FontSize="14" Margin="0,0,0,0"/>

                <!-- API Key -->
                <Label Content="API Key:"/>
                <PasswordBox x:Name="ApiKeyPasswordBox" Height="23"/>

                <!-- Host -->
                <Label Content="LLM Server URL (http://ip:port):"/>
                <TextBox x:Name="ServerTextBox"
                         Text="{Binding ServerURL, UpdateSourceTrigger=PropertyChanged}"
                         Height="23"/>

                <!-- Maximum Processing Length -->
                <Label Content="Maximum Processing Length for Web and File Content:"/>
                <TextBox x:Name="MaxContentLengthTextBox"
                        Text="{Binding MaxContentLength, UpdateSourceTrigger=PropertyChanged}"
                        Height="23"/>

                <!-- Model -->
                <Label Content="Model:"/>
                <TextBox x:Name="ModelTextBox"
                         Text="{Binding Model, UpdateSourceTrigger=PropertyChanged}"
                         Height="23"/>

                <!-- SearxNG Instance -->
                <Label Content="SearxNG Instance (optional) (must support JSON API):"/>
                <TextBox x:Name="SearxNGInstanceTextBox"
                         Text="{Binding SearxNGInstance, UpdateSourceTrigger=PropertyChanged}"
                         Height="23"/>

                <!-- System Prompt -->
                <Label Content="System Prompt:"/>
                <TextBox x:Name="SysPromptTextBox"
                         Text="{Binding SysPrompt, UpdateSourceTrigger=PropertyChanged}"
                         Height="23"/>



                <!-- Tools -->
                <Label Content="Tools:" Margin="0,0,0,0"/>
                <ListBox x:Name="ToolsListBox"
                         ItemsSource="{Binding AvailableTools}"
                         SelectionMode="Multiple"
                         Height="100">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <CheckBox IsChecked="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsSelected, Mode=TwoWay}">
                                <TextBlock Text="{Binding}"/>
                            </CheckBox>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <!-- Tools Requiring Approval -->
                <Label Content="Tools Requiring Approval:" Margin="0,0,0,0"/>
                <ListBox x:Name="ToolsRequiringApprovalListBox"
                         ItemsSource="{Binding AvailableTools}"
                         SelectionMode="Multiple"
                         Height="100">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <CheckBox IsChecked="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsSelected, Mode=TwoWay}">
                                <TextBlock Text="{Binding}"/>
                            </CheckBox>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="SaveButton" Content="OK" Width="75" Height="23"
                        Margin="0,0,8,0" Click="SaveButton_Click" IsDefault="True"/>
            <Button x:Name="CancelButton" Content="Cancel" Width="75" Height="23"
                        Click="CancelButton_Click" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
